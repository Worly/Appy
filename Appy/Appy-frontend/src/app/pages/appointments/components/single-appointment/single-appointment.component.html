<app-loading *ngIf="isLoading"></app-loading>
<div *ngIf="!isLoading && appointment != null">
    <div class="header">
        <div class="title">{{appointment.service?.name}}</div>
        <app-appointment-status-lookup class="status" [value]="appointment.status"
            (valueChange)="onChangeStatus($event)" [disabled]="isLoadingStatusChange"
            [isLoading]="isLoadingStatusChange"></app-appointment-status-lookup>
    </div>

    <div class="date">
        <fa-icon icon="calendar-days" [fixedWidth]="true"></fa-icon>
        <div>
            {{appointment.date?.format("DD.MM.YYYY - dddd")}}
        </div>
    </div>

    <div class="time">
        <fa-icon icon="clock" [fixedWidth]="true"></fa-icon>
        <div>
            {{appointment.time?.format("HH:mm")}} -
            {{appointment.time?.add($any(appointment.duration))?.format("HH:mm")}}
            ({{$any(appointment.duration) | formatDuration}})
        </div>
    </div>

    <app-button *ngIf="appointment.client != null" class="client-button"
        (onClick)="goToClient($any(appointment.client.id))">
        <div class="client">
            <div class="client-column">
                <div class="full-name">{{appointment.client.name}} {{appointment.client.surname}}</div>
            </div>

            <app-button *ngIf="appointment.client.contacts != null && appointment.client.contacts.length > 0"
                look="transparent" iconPrefix="fab" [icon]="getContactTypeIcon(appointment.client.contacts[0].type)"
                [text]="appointment.client.contacts[0].value"
                (onClick)="openContact(appointment.client.contacts[0])"></app-button>
        </div>
    </app-button>

    <div class="notes" *ngIf="appointment.notes != null && appointment.notes != ''">
        <div class="notes-title">{{'pages.appointments.NOTES' | translate}}:</div>
        <div class="notes-body">{{appointment.notes}}</div>
    </div>

    <div class="created-updated-at">
        <div>
            <div>{{'CREATED_AT' | translate}}:</div>
            <div>{{appointment.createdAt?.format("DD.MM.YYYY HH:mm")}}</div>
        </div>
        <div>
            <div>{{'LAST_UPDATED_AT' | translate}}:</div>
            <div>{{appointment.lastUpdatedAt?.format("DD.MM.YYYY HH:mm")}}</div>
        </div>
    </div>
    
    <div *ngIf="editable" class="action-bar">
        <app-button icon="trash" color="danger" look="solid" text="{{'DELETE' | translate}}"
            [disabled]="isLoadingDelete" [isLoading]="isLoadingDelete" (onClick)="onDelete()">
        </app-button>
        <app-button style="margin-left: auto" icon="pen" text="{{'EDIT' | translate}}" (onClick)="goToEdit()">
        </app-button>
    </div>
</div>